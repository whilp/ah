# Makefile Patterns

cosmic projects use Makefiles generated by `cosmic --make` to compile, type-check, format-check, and test code. see `cosmic --skill make` for full details on Makefile generation.

## Common Targets

```bash
cosmic --make . build     # compile .tl to .lua
cosmic --make . check     # type-check all files
cosmic --make . format    # check formatting
cosmic --make . test      # run tests and report results
cosmic --make . ci        # run format + check + test
cosmic --make . clean     # remove build artifacts
```

or save and use the Makefile directly:

```bash
cosmic --make > Makefile
make test
make ci
```

## Test Environment

each test gets:
- `TEST_TMPDIR` — isolated temp directory (cleaned after test)
- `TEST_BIN` — path to the build output bin directory
- `NO_COLOR=1` — disable colored output

## Customization

the generated Makefile includes `-include cosmic.mk` at the top. create `cosmic.mk` to override variables:

```makefile
# cosmic.mk — project-local overrides
COSMIC = ./bin/cosmic
BUILD_DIR = build
```

configurable variables:
- `COSMIC` — path to the cosmic binary (default: `cosmic`)
- `SRC_DIR` — source directory (default: `.`)
- `BUILD_DIR` — output directory (default: `o`)
